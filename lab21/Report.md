# Отчет по лабораторной работе № 21
## по курсу "Практикум программирования"

Студент группы М8О-108Б-23 Соловьева Надежда Сергеевна

Работа выполнена 

Преподаватель: каф. 806 Севастьянов Виктор Сергеевич

1. **Тема**: Программирование на интерпретируемых командных языках  
2. **Цель работы**: Составить программу выполнения заданных действий над файлами на одном из интерпретируемых командных языков OC UNIX (Shell, Cshell, Bash). 
3. **Задание (Вариант №):** Вариант №19: Подсчет числа строк в исходных файлах (*.h, *.cpp) директории и подкаталогов с вычислением суммарной длины (в строках).
4. **Алгоритм решения:**  
   Программа на Bash:
     * count_lines() - Функция, получающая на вход название файла, считывающая его длину в строках и возвращающая это значение.
     * traverse_directory() - Основная функция, получающая на вход название директории и имеющее начальное значение переменной total_lines=0 (суммарная длина). Проверяем, существует ли введенная директория, в противном случае соответствующий вывод. С помощью цикла while проходимся по всем файлам данной директории и проверяем их на соотвестствие типу *.h или *.cpp. В случае соответствия для каждого файла с помощью функции count_lines() выводится его длина в строках, а переменная total_lines увеличивается на соответствующую длину. По окончанию цикла выводится суммарная длина в строках для всех подходящих по типу файлов.

   Дополнительные условия:  
      3. Если указан параметр "?", то выводится подсказка (спецификация программы).  
      8. Если параметры опущены, то устанавливаются некоторые стандартные значения параметров.  
6. **Тестовые данные:**

| Входные данные                                 | Выходные данные                                                       | Описание тестируемого случая                          |
|------------------------------------------------|-----------------------------------------------------------------------|-------------------------------------------------------|
| Введите имя директории ('?' для спецификации): | Вы не ввели директорию, поэтому было взято стандартное значение Test1 | Пример работы в случае отсутствия ввода директории и  |
|                                                | Файл: Test1/check_even_ord.cpp, Количество строк: 10                  | взятия стандартного значения                          |         
|                                                | Файл: Test1/adding_two_num.cpp, Количество строк: 9                   |                                                       |
|                                                | -------------------                                                   |                                                       |
|                                                | Суммарное количество строк: 19                                        |                                                       |
|                                                |                                                                       |                                                       |                          
| Введите имя директории ('?' для спецификации): | Спецификация программы:                                               | Пример работы в случае вызова спецификации программы  |
| ?                                              | Программа подсчитывает количество строк в файлах '*.h' и '*.cpp' в    |                                                       |
|                                                | указанной директории и ее подкаталогах.                               |                                                       |
|                                                |                                                                       |                                                       |
| Введите имя директории ('?' для спецификации): | Файл: Test2/sum_1_to_n.cpp, Количество строк: 12                      | Пример работы с обычной директорией                   |
| Test2                                          | Файл: Test2/check_prime.cpp, Количество строк: 21                     |                                                       |
|                                                | Файл: Test2/find_max_num.cpp, Количество строк: 12                    |                                                       |
|                                                | -------------------                                                   |                                                       |
|                                                | Суммарное количество строк: 45                                        |                                                       |
|                                                |                                                                       |                                                       |
| Введите имя директории ('?' для спецификации): | Файл: Test4/check_prime.cpp, Количество строк: 21                     | Пример работы с директорией, содержащей подкаталоги   |
| Test4                                          | Файл: Test4/Test4.1/check_even_ord.cpp, Количество строк: 10          |                                                       |
|                                                | Файл: Test4/Test4.1/adding_two_num.cpp, Количество строк: 9           |                                                       |
|                                                | -------------------                                                   |                                                       |
|                                                | Суммарное количество строк: 40                                        |                                                       |
|                                                |                                                                       |                                                       |
| Введите имя директории ('?' для спецификации): | -------------------                                                   | Пример работы с пустой директорией                    |
| Test3                                          | Суммарное количество строк: 0                                         |                                                       |
|                                                |                                                                       |                                                       |
| Введите имя директории ('?' для спецификации): | Директория не существует                                              | Пример работы с несуществующей директорией            |
| test1                                          |                                                                       |                                                       |

7. **Протокол**:

    Программа на Bash: [count_lines.sh](/count_lines.sh)  
  ```
#!/bin/bash

# подсчет числа строк в файле
count_lines() {
    file="$1"
    lines=$(wc -l < "$file")
    echo "$lines"
}

# обход директории и ее подкаталогов
traverse_directory() {
    directory="$1"
    total_lines=0

    # проверяем, существует ли указанная директория
    if [ -d "$directory" ]; then
        while IFS= read -r file; do
            if [[ $file == *".h" ]] || [[ $file == *".cpp" ]]; then
                lines=$(count_lines "$file")
                echo "Файл: $file, Количество строк: $lines"
                total_lines=$((total_lines + lines))
            fi
        done < <(find "$directory" -type f)

        echo "-------------------"
        echo "Суммарное количество строк: $total_lines"
    else
        echo "Директория не существует"
        exit 1
    fi
}

echo "Введите имя директории ('?' для спецификации):"
read directory

# проверка вывода спецификации программы
if [[ "$directory" == "?" ]]; then
    echo "Спецификация программы:"
    echo "Программа подсчитывает количество строк в файлах '*.h' и '*.cpp' в указанной директории и ее подкаталогах."
    exit 0
fi

# Проверяем пустой ввод для параметра directory и устанавливаем стандартное значение
if [[ -z "$directory" ]]; then
    directory='Test1'
    echo "Вы не ввели директорию, поэтому было взято стандартное значение Test1"
fi


traverse_directory "$directory"
  ```

  Листинг работы:  
  ```
hopeee@hopeeenad:~/repository/Lab/lab21$ bash count_lines.sh
Введите имя директории ('?' для спецификации):

Вы не ввели директорию, поэтому было взято стандартное значение Test1
Файл: Test1/check_even_ord.cpp, Количество строк: 10
Файл: Test1/adding_two_num.cpp, Количество строк: 9
-------------------
Суммарное количество строк: 19
hopeee@hopeeenad:~/repository/Lab/lab21$ bash count_lines.sh
Введите имя директории ('?' для спецификации):
?
Спецификация программы:
Программа подсчитывает количество строк в файлах '*.h' и '*.cpp' в указанной директории и ее подкаталогах.
hopeee@hopeeenad:~/repository/Lab/lab21$ bash count_lines.sh
Введите имя директории ('?' для спецификации):
Test3
-------------------
Суммарное количество строк: 0
hopeee@hopeeenad:~/repository/Lab/lab21$ bash count_lines.sh
Введите имя директории ('?' для спецификации):
Test4
Файл: Test4/check_prime.cpp, Количество строк: 21
Файл: Test4/Test4.1/check_even_ord.cpp, Количество строк: 10
Файл: Test4/Test4.1/adding_two_num.cpp, Количество строк: 9
-------------------
Суммарное количество строк: 40
hopeee@hopeeenad:~/repository/Lab/lab21$ bash count_lines.sh
Введите имя директории ('?' для спецификации):
Test2
Файл: Test2/sum_1_to_n.cpp, Количество строк: 12
Файл: Test2/check_prime.cpp, Количество строк: 21
Файл: Test2/find_max_num.cpp, Количество строк: 12
-------------------
Суммарное количество строк: 45
hopeee@hopeeenad:~/repository/Lab/lab21$ bash count_lines.sh
Введите имя директории ('?' для спецификации):
test1
Директория не существует
hopeee@hopeeenad:~/repository/Lab/lab21$
  ```
  
7. Вывод: В процессе работы познакомились с интерпретируемыми командными языками программирования и научились писать код на Bash. В целом работа понравилась, она была не особо сложной и позволила научиться многому новому.  
Итог: 8/10.   
